--CRIANDO BANCO
--CREATE DATABASE FARMACIA_SEU_ZE;

--==============================================================CRIANDO AS SEQUENCES=========================================================--

CREATE SEQUENCE SEQ_FZ_CLIENTE
    INCREMENT 1
    MINVALUE 1 
    MAXVALUE 99999999999
    START 1
    CACHE 1 
;

CREATE SEQUENCE SEQ_FZ_PEDIDO
    INCREMENT 1
    MINVALUE 1 
    MAXVALUE 99999999999
    START 1
    CACHE 1 
;

CREATE SEQUENCE SEQ_FZ_PRODUTO
    INCREMENT 1
    MINVALUE 1 
    MAXVALUE 99999999999
    START 1
    CACHE 1 
;

CREATE SEQUENCE SEQ_FZ_FATURA
    INCREMENT 1
    MINVALUE 1 
    MAXVALUE 99999999999
    START 1
    CACHE 1 
;

CREATE SEQUENCE SEQ_FZ_NOTA_FISCAL
    INCREMENT 1
    MINVALUE 1 
    MAXVALUE 99999999999
    START 1
    CACHE 1 
;

CREATE SEQUENCE SEQ_FZ_ITEM
    INCREMENT 1
    MINVALUE 1 
    MAXVALUE 99999999999
    START 1
    CACHE 1 
;

CREATE SEQUENCE SEQ_FZ_EMPRESA
    INCREMENT 1
    MINVALUE 1 
    MAXVALUE 99999999999
    START 1
    CACHE 1 
;

CREATE SEQUENCE SEQ_FZ_CTE
    INCREMENT 1
    MINVALUE 1 
    MAXVALUE 99999999999
    START 1
    CACHE 1 
;

CREATE SEQUENCE SEQ_FZ_TRANSPORTADORA
    INCREMENT 1
    MINVALUE 1 
    MAXVALUE 99999999999
    START 1
    CACHE 1 
;

--================================================================CRIANDO ENUMERATED'S==============================================================--

CREATE TYPE ENUM_STATUS_PEDIDO AS ENUM ('ABERTO', 'ENCERRADO', 'LIQUIDADO');
CREATE TYPE ENUM_TIPO_PGTO AS ENUM ('DINHEIRO', 'PIX', 'BOLETO_ECOMMERCE', 'BOLETO_A_PRAZO', 'CARTAO');
CREATE TYPE ENUM_TIPO_FRETE AS ENUM ('0 - CIF', '1 - FOB','2 - Contratação do Frete por conta de Terceiros',
'3 - Transporte Próprio por conta do Remetente','4 - Transporte Próprio por conta do Destinatário', '9 - Sem Ocorrência de Transporte');

--================================================================CRIANDO AS TABELAS==============================================================--

--NECESSARIAMENTE PRECISA SER CRIADO NESSA ORDEM LÓGICA

CREATE TABLE FZ_CLIENTE (
    ID_CLIENTE INTEGER DEFAULT NEXTVAL('SEQ_FZ_CLIENTE'),
    RAZAO_SOCIAL VARCHAR(255) NOT NULL,
    CNPJ CHAR(14) NOT NULL,
    INSCRICAO_EST CHAR(9) NOT NULL,
    ENDERECO VARCHAR(255) NOT NULL,
    BAIRRO VARCHAR(70) NOT NULL,
    CEP VARCHAR(8) NOT NULL,
    MUNICIPIO VARCHAR(255) NOT NULL,
    TELEFONE CHAR(12),
    UF CHAR(2) NOT NULL,
    EMAIL VARCHAR(70),
    ATIVO NUMERIC(1),
    CREATED_AT TIMESTAMP, --BOAS PRÁTICAS LGPD
    UPDATED_AT TIMESTAMP, --BOAS PRÁTICAS LGPD
    PRIMARY KEY(ID_CLIENTE) 
);

CREATE TABLE FZ_PRODUTO (
    ID_PRODUTO INTEGER DEFAULT NEXTVAL('SEQ_FZ_PRODUTO'),
    NOME VARCHAR(255) NOT NULL,
    DESCRICAO VARCHAR(255) NOT NULL,
    VALOR NUMERIC(10,2) NOT NULL,
    URI_IMAGEM VARCHAR(255),
    PRIMARY KEY(ID_PRODUTO) 
);

CREATE TABLE FZ_PEDIDO (
    ID_PEDIDO INTEGER DEFAULT NEXTVAL('SEQ_FZ_PEDIDO'),
    ID_CLIENTE INTEGER REFERENCES FZ_CLIENTE(ID_CLIENTE) NOT NULL,
    DATA_GERACAO TIMESTAMP NOT NULL,
    STATUS_PEDIDO ENUM_STATUS_PEDIDO DEFAULT 'ABERTO',
    TIPO_PAGAMENTO ENUM_TIPO_PGTO NOT NULL,
    TOTAL NUMERIC(10,2) NOT NULL,
    PRIMARY KEY(ID_PEDIDO) 
);

CREATE TABLE FZ_PEDIDO_PRODUTO (
    ID_PEDIDO INTEGER REFERENCES FZ_PEDIDO(ID_PEDIDO) NOT NULL,
    ID_PRODUTO INTEGER REFERENCES FZ_PRODUTO(ID_PRODUTO) NOT NULL
);

CREATE TABLE FZ_FATURA (
    ID_FATURA INTEGER DEFAULT NEXTVAL('SEQ_FZ_FATURA'),
    ID_PEDIDO INTEGER REFERENCES FZ_PEDIDO(ID_PEDIDO) NOT NULL,
    NUMERO CHAR(10) NOT NULL,
    VENCIMENTO DATE NOT NULL,
    VALOR NUMERIC(10,2) NOT NULL,
    DATA_GERACAO TIMESTAMP NOT NULL,
    PRIMARY KEY(ID_FATURA) 
);

CREATE TABLE FZ_EMPRESA (
    ID_EMPRESA INTEGER DEFAULT NEXTVAL('SEQ_FZ_EMPRESA'),
    RAZAO_SOCIAL VARCHAR(255) NOT NULL,
    CNPJ CHAR(14) NOT NULL,
    INSCRICAO_EST CHAR(9) NOT NULL,
    ENDERECO VARCHAR(255) NOT NULL,
    BAIRRO VARCHAR(70) NOT NULL,
    CEP VARCHAR(8) NOT NULL,
    MUNICIPIO VARCHAR(255) NOT NULL,
    TELEFONE CHAR(12) NOT NULL,
    UF CHAR(2) NOT NULL,
    EMAIL VARCHAR(70),
    PRIMARY KEY(ID_EMPRESA) 
);

CREATE TABLE FZ_TRANSPORTADORA (
    ID_TRANSPORTADORA INTEGER DEFAULT NEXTVAL('SEQ_FZ_TRANSPORTADORA'),
    DESCRICAO VARCHAR(255),
    RAZAO_SOCIAL VARCHAR(255) NOT NULL,
    INSCRICAO_EST CHAR(9) NOT NULL,
    CNPJ CHAR(14) NOT NULL,
    CODIGO_ANTT CHAR(10),
    ENDERECO VARCHAR(255) NOT NULL,
    BAIRRO VARCHAR(70) NOT NULL,
    CEP VARCHAR(8) NOT NULL,
    MUNICIPIO VARCHAR(255) NOT NULL,
    TELEFONE CHAR(12) NOT NULL,
    UF CHAR(2) NOT NULL,
    EMAIL VARCHAR(70),
    PRIMARY KEY(ID_TRANSPORTADORA) 
);

CREATE TABLE FZ_CTE (
    ID_CTE INTEGER DEFAULT NEXTVAL('SEQ_FZ_CTE'),
    ID_CLIENTE INTEGER REFERENCES FZ_CLIENTE(ID_CLIENTE) NOT NULL,
    ID_TRANSPORTADORA INTEGER REFERENCES FZ_TRANSPORTADORA(ID_TRANSPORTADORA) NOT NULL,
    ID_EMPRESA INTEGER REFERENCES FZ_EMPRESA(ID_EMPRESA) NOT NULL,
    CHAVE_ACESSO VARCHAR(255) NOT NULL,
    MODAL CHAR(20) NOT NULL,
    NUMERO CHAR(10) NOT NULL,
    TIPO_FRETE ENUM_TIPO_FRETE NOT NULL,
    TOTAL NUMERIC(10,2) NOT NULL,
    CHAVE_NF CHAR(44) NOT NULL,
    INFO_ADICIONAL VARCHAR(255),
    DATA_HORA_EMISSAO TIMESTAMP NOT NULL,
    DATA_HORA_SAIDA TIMESTAMP NOT NULL,
    QUANTIDADE_ITEM NUMERIC(10),
    UNIDADE CHAR(20),
    PESO_BRUTO NUMERIC(10,2),
    PESO_LIQUIDO NUMERIC(10,2),
    PRIMARY KEY(ID_CTE) 
);

CREATE TABLE FZ_NOTA_FISCAL (
    ID_NOTA_FISCAL INTEGER DEFAULT NEXTVAL('SEQ_FZ_NOTA_FISCAL'),
    ID_PEDIDO INTEGER REFERENCES FZ_PEDIDO(ID_PEDIDO) UNIQUE NOT NULL,
    ID_CTE INTEGER REFERENCES FZ_CTE(ID_CTE) NOT NULL,
    ID_EMPRESA INTEGER REFERENCES FZ_EMPRESA(ID_EMPRESA) NOT NULL,
    CHAVE_ACESSO CHAR(44) UNIQUE NOT NULL,
    TIPO_ES NUMERIC(1) NOT NULL,
    MODELO CHAR(2) NOT NULL,
    NUMERO CHAR(10) NOT NULL,
    SERIE  CHAR(10) NOT NULL,
    BASE_CALC_ICMS NUMERIC(10,2) NOT NULL,
    VALOR_ICMS NUMERIC(10,2) NOT NULL,
    BASE_CALC_ICMS_SUBS NUMERIC(10,2),
    VALOR_ICMS_SUBS NUMERIC(10,2),
    VALOR_IPI NUMERIC(10,2),
    VALOR_TOTAL_PRODUTOS NUMERIC(10,2) NOT NULL,
    VALOR_FRETE NUMERIC(10,2),
    VALOR_SEGURO NUMERIC(10,2),
    VALOR_DESCONTO NUMERIC(10,2),
    VALOR_OUTROS_ENCARGOS NUMERIC(10,2),
    VALOR_TOTAL_NF NUMERIC(10,2),
    VALOR_ISSQN NUMERIC(10,2),
    ISSQN_TOTAL_SERVICO NUMERIC(10,2),
    ISSQN_INSCRICAO_MUNICIPAL CHAR(11),
    DATA_HORA_EMISSAO TIMESTAMP NOT NULL,
    INFO_ADICIONAL VARCHAR(255),
    PRIMARY KEY(ID_NOTA_FISCAL) 
);

CREATE TABLE FZ_ITEM (
    ID_ITEM INTEGER DEFAULT NEXTVAL('SEQ_FZ_ITEM'),
    CODIGO CHAR(10) NOT NULL,
    DESCRICAO VARCHAR(255) NOT NULL,
    UNIDADE CHAR(20),    
    VALOR NUMERIC(10,2) NOT NULL,
    QUANTIDADE NUMERIC(10)  NOT NULL,
    NCM_SH VARCHAR(20),
    CST CHAR(10),
    CFOP CHAR(10)  NOT NULL,
    BC_ICMS NUMERIC(10,2),
    ICMS NUMERIC(10,2),
    IPI NUMERIC(10,2),
    PORCENTAGEM_ICMS NUMERIC(4,2),
    PORCENTAGEM_IPI NUMERIC(4,2),
    PRIMARY KEY(ID_ITEM) 
);

CREATE TABLE FZ_NOTA_FISCAL_ITEM (
    ID_NOTA_FISCAL INTEGER REFERENCES FZ_NOTA_FISCAL(ID_NOTA_FISCAL) NOT NULL,
    ID_ITEM INTEGER REFERENCES FZ_ITEM(ID_ITEM) NOT NULL
);

--==================================================================INSERT'S=================================================================--

INSERT INTO FZ_CLIENTE (RAZAO_SOCIAL, CNPJ, INSCRICAO_EST, ENDERECO, BAIRRO, CEP, MUNICIPIO, TELEFONE, 
                        UF, EMAIL, ATIVO, CREATED_AT, UPDATED_AT)
    VALUES  ('Rosa e Caio Padaria Ltda', '23948235000105', '030108213', 'Rua Jundiaí, 409', 'Jardim Paraná',
             '81580460', 'Cascavel', '4137295033', 'PR', 'contabil@seuze.com.br', 1, NOW(), NOW()),
            ('Caroline e Carla Joalheria ME', '28019226000153', '798287303', 'Rua Joubert de Carvalho, 679', 'Jardim Mafra II',
             '87207370', 'Cascavel', '4426718814', 'PR', 'producao@joalheriame.com.br', 1, NOW(), NOW()),
             ('Alice Alimentos Ltda', '87246598000181', '953280868', 'Rua Francisco Machado, 250', 'Campina do Siqueira',
             '80740180', 'Curitiba', '4327506320', 'PR', 'juridico@alicealimentosltda.com.br', 1, NOW(), NOW()),
             ('Lavanderia Xeirinho Ltda', '17198818000163', '798070959', 'Rua Luiz Domingos Folador, 478', 'Nova Petrópolis',
             '86812336', 'Francisco Beltrão', '4638381000', 'PR', 'estoque@lavanderiaxerim.com.br', 1, NOW(), NOW()),
             ('Alexandre Telas ME', '63213746000101', '844515073', 'Rua Lótus, 157', 'Centro',
             '81940433', 'Francisco Beltrão', '4136036786', 'PR', 'financeiro@alexandretelasme.com.br', 1, NOW(), NOW()),
             ('Aparecida Vidros Ltda', '99704603000131', '386450854', 'Rua Estéfano Campitelli, 412', 'Minato',
             '87306445', 'Campo Mourão', '4439129213', 'PR', 'vendas@aparecidavidros.com.br', 1, NOW(), NOW());

SELECT * FROM FZ_CLIENTE;             

INSERT INTO FZ_PRODUTO (NOME, DESCRICAO, VALOR, URI_IMAGEM)
    VALUES  ('CoronaVac', 'Remedim pra um determinado tipos de virus', 225.50, 'http://github/images/fotineaCoronaVac'),
            ('Tarja Preta', 'Para quando se está mais louco que o tarço.', 200, 'http://github/images/TarjaPreta'),     
            ('Vic Vaporub', 'Remedim pra gripe.', 50, 'http://github/images/VicVaporub'),       
            ('Azulzinho', 'Aquela pra dar a moral.', 400, 'http://github/images/Azulzinho'),                            
            ('Ante Alergico', 'Pra quando se está mal.', 115.90, 'http://github/images/AnteAlergico'),                  
            ('Rexona', 'Ficar xerozim.', 15.90, 'http://github/images/rexona'),                                         
            ('Presaum Generico', 'Remedim pra pressão', 70.90, 'http://github/images/Presaum');                         

SELECT * FROM FZ_PRODUTO; 

INSERT INTO FZ_PEDIDO (ID_CLIENTE, DATA_GERACAO, STATUS_PEDIDO, TIPO_PAGAMENTO, TOTAL)
    VALUES  (1, NOW(), 'LIQUIDADO', 'PIX', 225.50),
            (2, NOW(), 'LIQUIDADO', 'DINHEIRO', 50),
            (5, NOW(), 'LIQUIDADO', 'BOLETO_ECOMMERCE', 115.90),
            (6, NOW(), 'ABERTO', 'BOLETO_A_PRAZO', 1200),
            (6, NOW(), 'LIQUIDADO', 'CARTAO', 200),
            (2, NOW(), 'ENCERRADO', 'CARTAO', 50),
            (3, NOW(), 'LIQUIDADO', 'PIX', 70.90),
            (1, NOW(), 'LIQUIDADO', 'DINHEIRO', 70.90),
            (6, NOW(), 'LIQUIDADO', 'CARTAO', 15.90),
            (4, NOW(), 'LIQUIDADO', 'BOLETO_ECOMMERCE', 400),
            (5, NOW(), 'LIQUIDADO', 'PIX', 200),
            (5, NOW(), 'LIQUIDADO', 'PIX', 200);

SELECT * FROM FZ_PEDIDO;             

INSERT INTO FZ_PEDIDO_PRODUTO (ID_PEDIDO, ID_PRODUTO)
    VALUES  (1, 1),
            (2, 3),
            (3, 5),
            (4, 4),
            (5, 2),
            (6, 3),            
            (7, 7),
            (8, 7),
            (9, 6),
            (10, 4),
            (11, 2),
            (12, 2);

SELECT * FROM FZ_PEDIDO_PRODUTO;   

INSERT INTO FZ_FATURA (ID_PEDIDO, NUMERO, VENCIMENTO, VALOR, DATA_GERACAO)
    VALUES  (1, '34343', NOW(), 225.50, NOW()),
            (2, '34347', NOW(), 50, NOW()),
            (3, '34348', NOW() + INTERVAL '3 DAY', 115.90, NOW()),
            (4, '34349', NOW() + INTERVAL '10 DAY', 400, NOW()),
            (4, '34350', NOW() + INTERVAL '30 DAY', 400, NOW()),
            (4, '34351', NOW() + INTERVAL '60 DAY', 400, NOW()),
            (5, '34352', NOW(), 200, NOW()),
            (6, '34353', NOW(), 50, NOW()),
            (7, '34354', NOW(), 70.90, NOW()),
            (8, '34355', NOW(), 70.90, NOW()),
            (9, '34356', NOW(), 15.90, NOW()),
            (10, '34357', NOW() + INTERVAL '3 DAY', 400, NOW()),
            (11, '34358', NOW(), 200, NOW()),
            (12, '34359', NOW(), 200, NOW());

SELECT * FROM FZ_PEDIDO_PRODUTO;   

INSERT INTO FZ_EMPRESA (RAZAO_SOCIAL, CNPJ, INSCRICAO_EST, ENDERECO, BAIRRO, CEP, MUNICIPIO, TELEFONE, UF, EMAIL)
    VALUES  ('Farmácia do seu Zé Ltda', '70564987000152', '851093631', 'Rua Estéfano Campitelli, 651', 'Jardim Planalto',
             '86084300', 'Cascavel', '4327506320', 'PR', 'contabil@seuze.com.br');

SELECT * FROM FZ_EMPRESA;               

INSERT INTO FZ_TRANSPORTADORA (DESCRICAO, RAZAO_SOCIAL, INSCRICAO_EST, CNPJ, CODIGO_ANTT, ENDERECO, BAIRRO, CEP, MUNICIPIO, TELEFONE, UF, EMAIL)
    VALUES  ('Fretes em geral','Leandro e Filipe Adega Ltda', '434902940', '46356350000196', '93777', 'Rua Guaracava-do-rio, 769', 'Parque Industrial Nova Era',
             '80330040', 'Curitiba', '4129254380', 'PR', 'contabil@lftransportes.com.br'),
            ('Fretes inter-urbanos região oeste','Benjamin e Simone TR ME', '480379292', '84590324000117', '44235', 'Rua Curupis, 587', 'Vila Morangueira',
             '85806137', 'Cascavel', '4235286450', 'PR', 'contato@BenjaminSimoneTR.com.br'),
            ('Fretes entre estados','Centauro Transportes', '593466213', '19036288000182', '58962', 'Rua Bogotá, 848', 'Portão III',
             '87040120', 'Maringá', '4437092249', 'PR', 'sistema@centaurotr.com.br');

SELECT * FROM FZ_TRANSPORTADORA;  

INSERT INTO FZ_CTE (ID_CLIENTE, ID_EMPRESA, ID_TRANSPORTADORA, CHAVE_ACESSO, MODAL, NUMERO, TIPO_FRETE, TOTAL, CHAVE_NF, INFO_ADICIONAL,
                    DATA_HORA_EMISSAO, DATA_HORA_SAIDA, QUANTIDADE_ITEM, UNIDADE, PESO_BRUTO, PESO_LIQUIDO)
    VALUES  (1, 1, 3, '36003954668363043165882889171774374670136963', 'Rodoviário', '2352454', '1 - FOB', 40, 
            '85153086253456513431634743213882307606321667', 'Frete com destino ao destinatario', NOW() + INTERVAL '1 DAY', 
            NOW() + INTERVAL '5 DAY', 1, 'Cx', 140, 89),
            (2, 1, 1, '85153086253456513431634743213882307606321667', 'Rodoviário', '3434543', '1 - FOB', 32.40, 
            '93472178920407792003761342987917364572475425', 'Frete do frete', NOW() + INTERVAL '2 DAY', 
            NOW() + INTERVAL '6 DAY', 1, 'Cx', 234, 167),
            (5, 1, 2, '25741089041593577942565992705897462560575725', 'Rodoviário', '4228793', '0 - CIF', 25.78, 
            '99662227642630616516782765180620596829693867', NULL, NOW(), 
            NOW() + INTERVAL '7 DAY', 1, 'Cx', 57, 42),
            (6, 1, 2, '53570470182752423962741185354859207355363648', 'Rodoviário', '9797518', '0 - CIF', 45.89, 
            '15549403741871908061810977968839393333708896', NULL, NOW() + INTERVAL '2 DAY', 
            NOW() + INTERVAL '8 DAY', 1, 'Cx', 44, 34),
            (3, 1, 2, '21739537633218376875151287215037100164837258', 'Rodoviário', '2352454', '0 - CIF', 110, 
            '92029731566261103181865530214563875748905521', NULL, NOW() + INTERVAL '1 DAY', 
            NOW() + INTERVAL '3 DAY', 1, 'Cx', 456.67, 442),
            (1, 1, 1, '37147210642991605399310547765739453274348538', 'Rodoviário', '3152414', '0 - CIF', 34.89, 
            '01398807671426689532787903266657896677334587', 'Frete com destino ao destinatario', NOW() + INTERVAL '2 DAY', 
            NOW() + INTERVAL '5 DAY', 1, 'Cx', 34, 34),
            (6, 1, 3, '69730953889584978086188286551568441546925874', 'Rodoviário', '0590674', '0 - CIF', 52.90, 
            '80209295508633615929970371248907037957517371', NULL, NOW(), 
            NOW() + INTERVAL '8 DAY', 1, 'Cx', 78.96, 54.98),
            (4, 1, 3, '63297379009639978520633578877394714451452326', 'Rodoviário', '1159296', '1 - FOB', 15, 
            '12839257657489747440442916385976150185951600', 'Boas festas', NOW() + INTERVAL '1 DAY', 
            NOW() + INTERVAL '2 DAY', 1, 'Cx', 456.87, 452.9),
            (5, 1, 1, '42756649425204000746145857538622998562404025', 'Rodoviário', '8029880', '1 - FOB', 43.90, 
            '40854572948706031475959546541375350818112982', NULL, NOW() + INTERVAL '1 DAY', 
            NOW() + INTERVAL '7 DAY', 1, 'Cx', 46.92, 29.78),
            (5, 1, 1, '62050682339606310182660865862318624792935996', 'Rodoviário', '1982102', '0 - CIF', 42, 
            '57675971818343566866354810802138805493584329', NULL, NOW() + INTERVAL '1 DAY', 
            NOW() + INTERVAL '6 DAY', 1, 'Cx', 59.84, 45.88);

SELECT * FROM FZ_CTE;

INSERT INTO FZ_NOTA_FISCAL (ID_PEDIDO, ID_CTE, ID_EMPRESA, CHAVE_ACESSO, TIPO_ES, MODELO, NUMERO, SERIE, BASE_CALC_ICMS, VALOR_ICMS, 
            BASE_CALC_ICMS_SUBS, VALOR_ICMS_SUBS, VALOR_IPI, VALOR_TOTAL_PRODUTOS, VALOR_FRETE, VALOR_SEGURO, VALOR_DESCONTO, VALOR_OUTROS_ENCARGOS, 
            VALOR_TOTAL_NF, VALOR_ISSQN, ISSQN_TOTAL_SERVICO, ISSQN_INSCRICAO_MUNICIPAL, DATA_HORA_EMISSAO, INFO_ADICIONAL)
    VALUES  (1,1,1, '77127018220167766115540079351599211913845852', 1, '55', '2432456', '1', 36.56, 70.18, NULL, NULL, 
            61.90, 225.50, 40.00, 0, 0, 0, 265.5, NULL, NULL, NULL, NOW() + INTERVAL '1 DAY', NULL),
            (2,2,1, '96456286997861431274933347547567112831531217', 1, '55', '2432456', '1', 12.88, 11, NULL, NULL, 
            61.90, 50.00, 32.40, 0, 0, 0, 82.40, NULL, NULL, NULL, NOW(), NULL),
            (3,3,1, '59655460370452622264738509497852818465402548', 1, '55', '2432456', '1', 23.98, 20.62, NULL, NULL, 
            61.90, 115.90, 25.78, 0, 0, 0, 141.68, NULL, NULL, NULL, NOW(), NULL),
            (5,4,1, '36703166115986694567360294483826496813524113', 1, '55', '2432456', '1', 49.47, 36.20, NULL, NULL, 
            61.90, 200.00, 45.89, 0, 0, 0, 245.89, NULL, NULL, NULL, NOW() + INTERVAL '1 DAY', NULL),
            (7,5,1, '97249514841161857862141358065304129170565671', 1, '55', '2432456', '1', 34.75, 18.66, NULL, NULL, 
            61.90, 70.90, 110.00, 0, 0, 0, 180.90, NULL, NULL, NULL, NOW() + INTERVAL '1 DAY', NULL),
            (8,6,1, '29179838984565287682486790708041969942731287', 1, '55', '2432456', '1', 34.75, 18.66, NULL, NULL, 
            61.90, 70.90, 34.89, 0, 0, 0, 105.79, NULL, NULL, NULL, NOW() + INTERVAL '1 DAY', NULL),
            (9,7,1, '79865951195748801785987530520138115610730305', 1, '55', '2432456', '1', 7.26, 5.57, NULL, NULL, 
            61.90, 15.90, 52.90, 0, 0, 0, 68.80, NULL, NULL, NULL, NOW(), NULL),
            (10,8,1, '68163934752863310368889718144941857141527703', 1, '55', '2432456', '1', 77.12, 70.18, NULL, NULL, 
            61.90, 400.00, 15.00, 0, 0, 0, 415, NULL, NULL, NULL, NOW(), NULL),
            (11,9,1, '59729146749927191699042948725281253168843735', 1, '55', '2432456', '1', 49.47, 36.20, NULL, NULL, 
            61.90, 200.00, 43.90, 0, 0, 0, 243.90, NULL, NULL, NULL, NOW() + INTERVAL '1 DAY', NULL),
            (12,10,1, '52401028542086417256147637420816056268013211', 1, '55', '2432456', '1', 49.47, 36.20, NULL, NULL, 
            61.90, 200.00, 42.00, 0, 0, 0, 242, NULL, NULL, NULL, NOW(), NULL);                    

SELECT * FROM FZ_NOTA_FISCAL;

INSERT INTO FZ_ITEM (CODIGO, DESCRICAO, UNIDADE, VALOR, QUANTIDADE, NCM_SH, CST, CFOP, BC_ICMS, ICMS, IPI, PORCENTAGEM_ICMS, PORCENTAGEM_IPI)
    VALUES  ('SRKU25', 'CoronaVac - Remedim pra um determinado tipos de virus','Caixa', 225.50,'1', NULL, '3444', '5912', 36.56, 70.18, NULL, 14.00, NULL),
            ('DEUH4F', 'Vic Vaporub - Remedim pra gripe','Caixa', 50.00, '1', NULL,'8153', '9178', 12.88, 11, NULL, 11.20, NULL),
            ('Z9IYMJ', 'Ante Alergico -Pra quando se está mal.','Caixa', 115.90,'1', NULL, '9506', '3854', 23.98, 20.62, NULL, 9.00, NULL),
            ('355N2H', 'Tarja Preta - Para quando se está mais louco que o tarço.','Caixa', 200.00,'1', NULL, '7902', '8716', 49.47, 36.20, NULL, 12.00, NULL),
            ('UJ6J29', 'Presaum Generico - Remedim pra pressão','Caixa', 70.90, '1', NULL,'3738', '0114', 34.75, 18.66, NULL, 52.00, NULL),
            ('JN20AR', 'Presaum Generico - Remedim pra pressão','Caixa', 70.90, '1', NULL,'1232', '9929', 34.75, 18.66, NULL, 52.00, NULL),
            ('JN20AR', 'Rexona - Ficar xerozim.','Caixa', 15.90, '1', NULL,'5738', '6072', 7.26, 5.57, NULL, 53.37, NULL),
            ('GBZLCC', 'Azulzinho - Aquela pra dar a moral.','Caixa', 400.00,'1', NULL, '2087', '0806', 77.12, 70.18, NULL, 25.46, NULL),
            ('DGC4YY', 'Tarja Preta - Para quando se está mais louco que o tarço.','Caixa', 200.00,'1', NULL, '1732', '1077', 49.47, 36.20, NULL, 36.30, NULL),
            ('1OPJJA', 'Tarja Preta - Para quando se está mais louco que o tarço.','Caixa', 200.00,'1', NULL, '6123', '2675', 49.47, 36.20, NULL, 36.30, NULL);

SELECT * FROM FZ_ITEM;

INSERT INTO FZ_NOTA_FISCAL_ITEM (ID_NOTA_FISCAL, ID_ITEM)
    VALUES  (1, 1),
            (2, 2),
            (3, 3),
            (4, 4),
            (5, 5),
            (6, 6),            
            (7, 7),
            (8, 8),
            (9, 9),
            (10, 10);

SELECT * FROM FZ_NOTA_FISCAL_ITEM;

---COMANDOS ÚTEIS
DROP TABLE FZ_ITEM;
DELETE FROM FZ_ITEM;
ALTER TABLE FZ_CTE ALTER COLUMN INFO_ADICIONAL DROP NOT NULL;
ALTER SEQUENCE public.SEQ_FZ_ITEM RESTART WITH 1;

--==================================================================SELECT'S=================================================================--

SELECT * FROM FZ_PEDIDO;
SELECT * FROM FZ_CLIENTE;
SELECT * FROM FZ_FATURA;
SELECT * FROM FZ_PRODUTO;
SELECT * FROM FZ_EMPRESA;
SELECT * FROM FZ_TRANSPORTADORA;
SELECT * FROM FZ_DESTINATARIO;
SELECT * FROM FZ_CTE;
SELECT * FROM FZ_NOTA_FISCAL;
SELECT * FROM FZ_ITEM;

--INNER JOIN  -- TRAZENDO UM PANORAMA GERAL NF
SELECT NF.ID_NOTA_FISCAL, NF.CHAVE_ACESSO AS CHAVE_NF, NF.MODELO AS MODELO_NF, NF.TIPO_ES, NF.VALOR_TOTAL_PRODUTOS AS VALOR_TOTAL_ITENS_NF, 
       NF.VALOR_FRETE AS VALOR_FRETE_NF, NF.DATA_HORA_EMISSAO AS DATA_EMISSAO_NF, IT.DESCRICAO AS ITEM_NF, IT.VALOR AS VALOR_ITEM_NF, 
       CT.ID_CTE, E.RAZAO_SOCIAL AS EMITENTE_CTE, C.RAZAO_SOCIAL AS DESTINATARIO_CTE, CT.TOTAL AS VALOR_CTE, CT.MODAL, CT.TIPO_FRETE, 
       TR.RAZAO_SOCIAL AS NOME_TRANSPORTADORA, P.ID_PEDIDO, P.STATUS_PEDIDO, P.TIPO_PAGAMENTO, F.ID_FATURA, F.NUMERO, 
       PDT.NOME AS PRODUTO_PEDIDO, PDT.VALOR AS VALOR_PRODUTO   
    FROM FZ_NOTA_FISCAL NF
  INNER JOIN FZ_CTE CT ON CT.ID_CTE = NF.ID_CTE
  INNER JOIN FZ_EMPRESA E ON E.ID_EMPRESA = CT.ID_EMPRESA
  INNER JOIN FZ_CLIENTE C ON C.ID_CLIENTE = CT.ID_CLIENTE
  INNER JOIN FZ_TRANSPORTADORA TR ON TR.ID_TRANSPORTADORA = CT.ID_TRANSPORTADORA
  INNER JOIN FZ_NOTA_FISCAL_ITEM NFI ON NFI.ID_NOTA_FISCAL = NF.ID_NOTA_FISCAL
  INNER JOIN FZ_ITEM IT ON IT.ID_ITEM = NFI.ID_ITEM
  INNER JOIN FZ_PEDIDO P ON P.ID_PEDIDO = NF.ID_PEDIDO
  INNER JOIN FZ_FATURA F ON F.ID_PEDIDO = P.ID_PEDIDO
  INNER JOIN FZ_PEDIDO_PRODUTO PP ON PP.ID_PEDIDO = P.ID_PEDIDO
  INNER JOIN FZ_PRODUTO PDT ON PDT.ID_PRODUTO = PP.ID_PRODUTO
ORDER BY NF.id_nota_fiscal DESC;

--SUB-QUERY -- TRAZENDO TODOS OS PEDIDOS DE CLIENTES DA CIDADE DE CASCAVEL
SELECT P.* 
    FROM FZ_PEDIDO P 
  WHERE ID_CLIENTE IN (
      SELECT ID_CLIENTE
          FROM FZ_CLIENTE
        WHERE MUNICIPIO = 'Cascavel' 
);

--CTE(COMMON TABLE EXPRESSION) -- TRAZENDO PRODUTOS COM VALOR MAIOR QUE 50 R$
WITH APENAS_PRODUTOS_VALOR_MAIOR_50 AS (
    SELECT * 
        FROM fz_produto 
      WHERE VALOR > 50
)
SELECT APENAS_PRODUTOS_VALOR_MAIOR_50.ID_PRODUTO, 
       APENAS_PRODUTOS_VALOR_MAIOR_50.NOME,
       APENAS_PRODUTOS_VALOR_MAIOR_50.DESCRICAO,
       APENAS_PRODUTOS_VALOR_MAIOR_50.VALOR
    FROM APENAS_PRODUTOS_VALOR_MAIOR_50;
